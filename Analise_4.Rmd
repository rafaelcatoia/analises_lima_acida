---
title: "Analises 2022"
author: "Rafael Catoia"
date: "12/10/2022"
output:
  html_document:
    code_folding: hide
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,message = FALSE,warning = FALSE)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
library(dplyr) ; library(ggplot2) ; library(ggthemes) ; library(tidyr)
```

```{r}
## Functions 
kable_cust = function(df_aux,ndec=5,cap=''){
  return(df_aux %>% knitr::kable(digits = ndec,caption = cap) %>% kableExtra::kable_styling())
}
```


# Estudo {.tabset}

Novo relatório com análises para Ana Júlia - Los Hermanos

## IRGA {.tabset}

### UFSCar {.tabset}

### CCSM {.tabset}

## Rhizotron {.tabset}
```{r}
dframe_rhiz = data.table::fread("/Users/rafaelcatoia/MyDrive/08_Consultorias/01_Ana_Julia/04_Projeto4/Dados/Rizhotron.txt")

dframe_rhiz_ufscar = dframe_rhiz %>%
  filter(Intituto=='UFSCar') %>% select(-Manejo,-Tratamentos) %>% 
  mutate(RegHidrico =factor(RegHidrico,levels = c('S','TRF','TRV')),
         Rhizotron_2022=10*Rhizotron_2022) %>% 
  pivot_longer(cols = c("Rhizotron_2021","Rhizotron_2022"),names_to = 'Safra',
               values_to = 'Rhizotron') %>% 
  mutate(Safra=gsub('Rhizotron_','',Safra))

dframe_rhiz_ccsm = dframe_rhiz %>%
  filter(Intituto=='CCSM') %>% select(-Tratamento,-Tratamentos) %>%  
  mutate(RegHidrico =factor(RegHidrico,levels = c('S','TRF','TRV'))) %>% 
  pivot_longer(cols = c("Rhizotron_2021","Rhizotron_2022"),names_to = 'Safra',
               values_to = 'Rhizotron') %>% 
  mutate(Safra=gsub('Rhizotron_','',Safra))
```

### UFSCar

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
dframe_summ_ufscar = dframe_rhiz_ufscar %>%
    select(Safra,RegHidrico,Tratamento,Rhizotron) %>%
    group_by(Safra,RegHidrico,Tratamento) %>% 
    summarise(Mean = mean(Rhizotron,na.rm=T),
              SD = sd(Rhizotron,na.rm=T)) %>% 
  mutate(`Mean ± SD`=paste(round(Mean,5),'±',round(SD,5)))
```

#### Graficos {.tabset}
##### Gráfico De Barras {.tabset}
###### Option 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
yname = 'Média de rhizotron'
dframe_summ_ufscar %>% ggplot(
      aes(x=Tratamento,
          fill=RegHidrico,
          y=Mean)) +
    geom_bar(stat = 'identity',position = 'dodge')+
    facet_wrap(~Safra)+
    theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
    scale_color_gdocs()+
    scale_fill_gdocs()+
    ylab(yname)
```

###### Option 2

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
dframe_summ_ufscar %>% ggplot(
      aes(x=RegHidrico,
          fill=Tratamento,
          y=Mean)) +
    geom_bar(stat = 'identity',position = 'dodge')+
    facet_wrap(~Safra)+
    theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
    scale_color_gdocs()+
    scale_fill_gdocs()+
    ylab(yname)
```


##### Gráfico De Barras com erro {.tabset}

###### Option 1

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
dframe_summ_ufscar %>% ggplot(
  aes(x=Tratamento,
      fill=RegHidrico,
      y=Mean)) +
  geom_bar(stat = 'identity',position = position_dodge(),alpha=0.9)+
  geom_errorbar(
    aes(x=Tratamento,y=Mean,
        color=RegHidrico,
        #linetype=RegHidrico,
        ymin=Mean-SD,ymax=Mean+SD),
    width = 0.2,alpha=0.8,stat = 'identity',color='black',
    position = position_dodge(0.9))+
  facet_wrap(~Safra)+
  theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
  scale_color_gdocs()+
  scale_fill_gdocs()+
  ylab(yname)
```

###### Option 2

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
dframe_summ_ufscar %>% ggplot(
  aes(x=RegHidrico,
      fill=Tratamento,
      y=Mean)) +
  geom_bar(stat = 'identity',position = position_dodge(),alpha=0.9)+
  geom_errorbar(
    aes(x=RegHidrico,y=Mean,
        color=Tratamento,
        #linetype=RegHidrico,
        ymin=Mean-SD,ymax=Mean+SD),
    width = 0.2,alpha=0.8,stat = 'identity',color='black',
    position = position_dodge(0.9))+
  facet_wrap(~Safra)+
  theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
  scale_color_gdocs()+
  scale_fill_gdocs()+
  ylab(yname)
```

##### Gráfico de Pontos + Média e Erro {.tabset}

###### Option 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
dframe_rhiz_ufscar %>% ggplot()+
    facet_wrap(~Safra,scales='free')+
    geom_point(aes(x=Tratamento,y=Rhizotron,
                          color=RegHidrico,
                          shape=RegHidrico),
               position = position_dodge(width = .75),alpha=0.5)+
    geom_point(aes(x=Tratamento,y=Mean,
                          color=RegHidrico,
                          shape=RegHidrico),
               data=dframe_summ_ufscar,
               position = position_dodge(width = .75))+
    geom_errorbar(aes(x=Tratamento,y=Mean,
                          color=RegHidrico,
                          linetype=RegHidrico,
                      ymin=Mean-SD,ymax=Mean+SD),
                  data=dframe_summ_ufscar,
                  width = 0.2,alpha=0.9,
                  position = position_dodge(0.75))+
    theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
    scale_color_gdocs()+
    scale_fill_gdocs()
```

###### Option 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
dframe_rhiz_ufscar %>% ggplot()+
    facet_wrap(~Safra,scales='free')+
    geom_point(aes(x=RegHidrico,y=Rhizotron,
                          color=Tratamento,
                          shape=Tratamento),
               position = position_dodge(width = .75),alpha=0.5)+
    geom_point(aes(x=RegHidrico,y=Mean,
                          color=Tratamento,
                          shape=Tratamento),
               data=dframe_summ_ufscar,
               position = position_dodge(width = .75))+
    geom_errorbar(aes(x=RegHidrico,y=Mean,
                          color=Tratamento,
                          linetype=Tratamento,
                      ymin=Mean-SD,ymax=Mean+SD),
                  data=dframe_summ_ufscar,
                  width = 0.2,alpha=0.9,
                  position = position_dodge(0.75))+
    theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
    scale_color_gdocs()+
    scale_fill_gdocs()
```


##### Tabela Resumo

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
dframe_summ_ufscar %>% select(Safra,RegHidrico,Tratamento,`Mean ± SD`) %>% kable_cust(cap = 'Média e Desvio Padrao - Rhizotron')
```

#### Modelo {.tabset}

##### 2021 
```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
df_tk <- dframe_rhiz_ufscar %>% filter(Safra=='2021')
fit_lm <- lm(data=df_tk,
          formula = Rhizotron~RegHidrico+Tratamento+RegHidrico*Tratamento)

fit_aov <- aov(data=df_tk,
          formula = Rhizotron~RegHidrico+Tratamento+RegHidrico*Tratamento)

summ_lm = summary(fit_lm)
summ_aov = summary(fit_aov)
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
tk <- TukeyHSD(fit_aov)
mtcomp <- multcompView::multcompLetters4(fit_aov,tk)

summ_tk <- df_tk %>% group_by(RegHidrico,Tratamento) %>% 
  summarise(mean=mean(Rhizotron)) %>% arrange(-mean) 

summ_tk$Group =as.data.frame.list(mtcomp$`RegHidrico:Tratamento`)[,1]

summ_tk %>% kable_cust()
#tx <- with(data = df_tk,interaction(RegHidrico,Tratamento))
#amod <- aov(Rhizotron ~ RegHidrico+Tratamento+tx, data=df_tk)
#Tukey = agricolae::HSD.test(amod,trt = 'tx',group=TRUE)
#Tukey$groups %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(fit_lm)
par(mfrow=c(1,1))
```

```{r}
summ_aov
```

```{r}
summ_lm$coefficients %>% kable_cust()
```

##### 2022 
```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
df_tk <- dframe_rhiz_ufscar %>% filter(Safra=='2022')
fit_lm <- lm(data=df_tk,
          formula = Rhizotron~RegHidrico+Tratamento+RegHidrico*Tratamento)

fit_aov <- aov(data=df_tk,
          formula = Rhizotron~RegHidrico+Tratamento+RegHidrico*Tratamento)

summ_lm = summary(fit_lm)
summ_aov = summary(fit_aov)
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
tk <- TukeyHSD(fit_aov)
mtcomp <- multcompView::multcompLetters4(fit_aov,tk)

summ_tk <- df_tk %>% group_by(RegHidrico,Tratamento) %>% 
  summarise(mean=mean(Rhizotron)) %>% arrange(-mean) 

summ_tk$Group = as.data.frame.list(mtcomp$`RegHidrico:Tratamento`)[,1]

summ_tk %>% kable_cust()

#tx <- with(data = df_tk,interaction(RegHidrico,Tratamento))
#amod <- aov(Rhizotron ~ RegHidrico+Tratamento+tx, data=df_tk)
#
#Tukey = agricolae::HSD.test(amod,trt = 'tx',group=TRUE)
#Tukey$groups %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(fit_lm)
par(mfrow=c(1,1))
```

```{r}
summ_aov
```

```{r}
summ_lm$coefficients %>% kable_cust()
```


### CCSM 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
dframe_summ_ccsm = dframe_rhiz_ccsm %>%
    select(Safra,Manejo,Copa,PortaEnxerto,Rhizotron) %>%
    group_by(Safra,Manejo,Copa,PortaEnxerto) %>% 
    summarise(Mean = mean(Rhizotron,na.rm=T),
              SD = sd(Rhizotron,na.rm=T)) %>% 
  mutate(`Mean ± SD`=paste(round(Mean,5),'±',round(SD,5)))
```

#### Graficos {.tabset}

##### Gráfico de Barras {.tabset}

###### Option 1

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
yname = 'Média de rhizotron'
dframe_summ_ccsm %>% ggplot(
      aes(x=PortaEnxerto,
          fill=Copa,
          y=Mean)) +
    geom_bar(stat = 'identity',position = 'dodge')+
    facet_wrap(Safra~Manejo,nrow=1)+
    theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
    scale_color_gdocs()+
    scale_fill_gdocs()+
    ylab(yname)
```

###### Option 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
dframe_summ_ccsm %>% ggplot(
      aes(x=Copa,
          fill=PortaEnxerto,
          y=Mean)) +
    geom_bar(stat = 'identity',position = 'dodge')+
    facet_wrap(Safra~Manejo,nrow=1)+
    theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
    scale_color_gdocs()+
    scale_fill_gdocs()+
    ylab(yname)
```

##### Gráfico de Barras com erro {.tabset}

###### Option 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
dframe_summ_ccsm %>% ggplot(
  aes(x=PortaEnxerto,
          fill=Copa,
      y=Mean)) +
  geom_bar(stat = 'identity',position = position_dodge(),alpha=0.9)+
  geom_errorbar(
    aes(x=PortaEnxerto,y=Mean,
        color=Copa,
        ymin=Mean-SD,ymax=Mean+SD),
    width = 0.2,alpha=0.8,stat = 'identity',color='black',
    position = position_dodge(0.9))+
  facet_wrap(Safra~Manejo,nrow=1)+
  theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
  scale_color_gdocs()+
  scale_fill_gdocs()+
  ylab(yname)
```

###### Option 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
dframe_summ_ccsm %>% ggplot(
  aes(x=Copa,
          fill=PortaEnxerto,
      y=Mean)) +
  geom_bar(stat = 'identity',position = position_dodge(),alpha=0.9)+
  geom_errorbar(
    aes(x=Copa,y=Mean,
        color=PortaEnxerto,
        ymin=Mean-SD,ymax=Mean+SD),
    width = 0.2,alpha=0.8,stat = 'identity',color='black',
    position = position_dodge(0.9))+
  facet_wrap(Safra~Manejo,nrow=1)+
  theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
  scale_color_gdocs()+
  scale_fill_gdocs()+
  ylab(yname)
```


##### Gráfico de Pontos + Média e Erro {.tabset}

###### Option 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
dframe_rhiz_ccsm %>% ggplot()+
  facet_wrap(~Safra)+
  geom_point(aes(x=PortaEnxerto,
                 y=Rhizotron,
                 color=Copa,
                 shape=Manejo),
             position = position_dodge(width = .75),alpha=0.5)+
  geom_point(aes(x=PortaEnxerto,
                 y=Mean,
                 color=Copa,
                 shape=Manejo),
             data=dframe_summ_ccsm,
             position = position_dodge(width = .75))+
  geom_errorbar(aes(x=PortaEnxerto,
                 y=Mean,
                 color=Copa,
                 shape=Manejo,
                ymin=Mean-SD,ymax=Mean+SD),
                data=dframe_summ_ccsm,
                width = 0.2,alpha=0.9,
                position = position_dodge(0.75))+
  theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
  scale_color_gdocs()+
  scale_fill_gdocs()
```

###### Option 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
dframe_rhiz_ccsm %>% ggplot()+
  facet_wrap(~Safra)+
  geom_point(aes(x=Copa,
                 y=Rhizotron,
                 color=PortaEnxerto,
                 shape=Manejo),
             position = position_dodge(width = .75),alpha=0.5)+
  geom_point(aes(x=Copa,
                 y=Mean,
                 color=PortaEnxerto,
                 shape=Manejo),
             data=dframe_summ_ccsm,
             position = position_dodge(width = .75))+
  geom_errorbar(aes(x=Copa,
                 y=Mean,
                 color=PortaEnxerto,
                 shape=Manejo,
                ymin=Mean-SD,ymax=Mean+SD),
                data=dframe_summ_ccsm,
                width = 0.2,alpha=0.9,
                position = position_dodge(0.75))+
  theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
  scale_color_gdocs()+
  scale_fill_gdocs()
```


##### Tabela Resumo

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
dframe_summ_ccsm %>% select(Safra,Manejo,PortaEnxerto,Copa,`Mean ± SD`) %>% kable_cust(cap = 'Média e Desvio Padrao - Rhizotron')
```

#### Modelo {.tabset}

##### 2021 
```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
df_tk <- dframe_rhiz_ccsm %>% filter(Safra=='2021')
fit_lm <- lm(data=df_tk,
          formula = Rhizotron~Manejo+Copa +PortaEnxerto+
            Manejo*Copa+Manejo*PortaEnxerto +
            Copa*PortaEnxerto+
            Manejo*Copa*PortaEnxerto
          )

fit_aov <- aov(data=df_tk,
          formula = Rhizotron~Manejo+Copa +PortaEnxerto+
            Manejo*Copa+#Manejo*PortaEnxerto +
            Copa*PortaEnxerto+#+
            Manejo*Copa*PortaEnxerto
          )

summ_lm = summary(fit_lm)
summ_aov = summary(fit_aov)
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
tk <- TukeyHSD(fit_aov)
mtcomp <- multcompView::multcompLetters4(fit_aov,tk)

summ_tk <- df_tk %>% group_by(Manejo,Copa,PortaEnxerto) %>% 
  summarise(mean=mean(Rhizotron)) %>% arrange(-mean) 

summ_tk$Group =as.data.frame.list(mtcomp$`Manejo:Copa:PortaEnxerto`)[,1]

summ_tk %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(fit_lm)
par(mfrow=c(1,1))
```

```{r}
summ_aov
```

```{r}
summ_lm$coefficients %>% kable_cust()
```

##### 2022 
```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
df_tk <- dframe_rhiz_ccsm %>% filter(Safra=='2022')
fit_lm <- lm(data=df_tk,
          formula = Rhizotron~
            #Manejo+
            Copa +PortaEnxerto+
            #Manejo*Copa+Manejo*PortaEnxerto +
            Copa*PortaEnxerto#+
            #Manejo*Copa*PortaEnxerto
          )

fit_aov <- aov(data=df_tk,
          formula = Rhizotron~
            Manejo+Copa +PortaEnxerto+
            Manejo*Copa+Manejo*PortaEnxerto +
            Copa*PortaEnxerto+
            Manejo*Copa*PortaEnxerto
          )

summ_lm = summary(fit_lm)
summ_aov = summary(fit_aov)
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
tk <- TukeyHSD(fit_aov)
mtcomp <- multcompView::multcompLetters4(fit_aov,tk)

summ_tk <- df_tk %>% group_by(Copa,PortaEnxerto) %>% 
  summarise(mean=mean(Rhizotron)) %>% arrange(-mean) 

summ_tk$Group =as.data.frame.list(mtcomp$`Copa:PortaEnxerto`)[,1]

summ_tk %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(fit_lm)
par(mfrow=c(1,1))

par(mfrow=c(2,2))
plot(fit_aov)
par(mfrow=c(1,1))
```

```{r}
summ_aov
```

```{r}
summ_lm$coefficients %>% kable_cust()
```


## Potencial Hidrico {.tabset}

### UFSCar {.tabset}

### CCSM {.tabset}

## Desenvolvimento Vegetativo {.tabset}
```{r}
dframe_dv = data.table::fread("/Users/rafaelcatoia/MyDrive/08_Consultorias/01_Ana_Julia/04_Projeto4/Dados/DesenvVegetativo.txt")

#dframe_qf_ufscar = dframe_qf %>%
#  filter(Instituto=='UFSCar') %>% select(-Manejo) %>% 
#  mutate(RegHidrico =factor(RegHidrico,levels = c('S','TRF','TRV')))
#
#dframe_qf_ccsm = dframe_qf %>%
#  filter(Instituto=='CCSM') %>% select(-Tratamento) %>%  
#  mutate(RegHidrico =factor(RegHidrico,levels = c('S','TRF','TRV')))
```


### UFSCar {.tabset}

### CCSM {.tabset}

## Qualidade do fruto {.tabset}
```{r}
dframe_qf = data.table::fread("/Users/rafaelcatoia/MyDrive/08_Consultorias/01_Ana_Julia/04_Projeto4/Dados/QualidadeFruto.txt")

dframe_qf_ufscar = dframe_qf %>%
  filter(Instituto=='UFSCar') %>% select(-Manejo) %>% 
  mutate(RegHidrico =factor(RegHidrico,levels = c('S','TRF','TRV')))

dframe_qf_ccsm = dframe_qf %>%
  filter(Instituto=='CCSM') %>% select(-Tratamento) %>%  
  mutate(RegHidrico =factor(RegHidrico,levels = c('S','TRF','TRV')))
```

```{r}
summ_qf <- function(dframe,variable_name = ''){
  if (variable_name==''){
    stop()
  }
  dframe = dframe %>% select(one_of(variable_name),RegHidrico,Tratamento)
  
  
  colnames(dframe)[1]<-'Y'
  out<- list()
  
  dframe_summ <- dframe %>% group_by(RegHidrico,Tratamento) %>% 
    summarise(Mean = mean(Y,na.rm=T),
              SD = sd(Y,na.rm=T)) %>% 
    mutate(`Mean ± SD`=paste(round(Mean,2),'±',round(SD,2)))
  
  out$dframe_summ <- dframe_summ
  
  out$barp <- dframe_summ %>% ggplot(
    aes(x=RegHidrico,
        fill=Tratamento,
        y=Mean)) +
    geom_bar(stat = 'identity',position = 'dodge')+
    theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
    scale_color_gdocs()+
    scale_fill_gdocs()+
    ylab(paste('Média de', variable_name ))
  
  out$barp_2 <- dframe_summ %>% ggplot(
    aes(x=Tratamento,
        fill=RegHidrico,
        y=Mean)) +
    geom_bar(stat = 'identity',position = 'dodge')+
    theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
    scale_color_gdocs()+
    scale_fill_gdocs()+
    ylab(paste('Média de', variable_name ))
  
  out$barp_error <-  dframe_summ %>% ggplot(
    aes(x=RegHidrico,
        fill=Tratamento,
        y=Mean)) +
    geom_bar(stat = 'identity',position = 'dodge')+
    theme_minimal(base_size=14)+theme(legend.position = 'bottom') +
    geom_errorbar(
      aes(x=RegHidrico,y=Mean,
          color=Tratamento,
          ymin=Mean-SD,ymax=Mean+SD),
      width = 0.2,alpha=0.8,stat = 'identity',color='black',
      position = position_dodge(0.9))+
    scale_color_gdocs()+
    scale_fill_gdocs()+
    ylab(paste('Média de', variable_name ))
  
  out$barp_error_2 <-  dframe_summ %>% ggplot(
    aes(x=Tratamento,
        fill=RegHidrico,
        y=Mean)) +
    geom_bar(stat = 'identity',position = 'dodge')+
    theme_minimal(base_size=14)+theme(legend.position = 'bottom') +
    geom_errorbar(
      aes(x=Tratamento,y=Mean,
          color=RegHidrico,
          ymin=Mean-SD,ymax=Mean+SD),
      width = 0.2,alpha=0.8,stat = 'identity',color='black',
      position = position_dodge(0.9))+
    scale_color_gdocs()+
    scale_fill_gdocs()+
    ylab(paste('Média de', variable_name ))
  
  out$mean_desv_plot <-
    dframe %>% ggplot()+
    geom_point(aes(
      x=RegHidrico,
      y=Y,
      color=Tratamento,
      shape=Tratamento),
      position = position_dodge(width = .75),alpha=0.5)+
    geom_point(aes(
      x=RegHidrico,
      y=Mean,
      color=Tratamento,
      shape=Tratamento),
      data=dframe_summ,
      position = position_dodge(width = .75))+
    geom_errorbar(aes(
      x=RegHidrico,
      y=Mean,
      color=Tratamento,
      shape=Tratamento,
      ymin=Mean-SD,ymax=Mean+SD),
      data=dframe_summ,
      width = 0.2,alpha=0.9,
      position = position_dodge(0.75))+
    theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
    scale_color_gdocs()+
    scale_fill_gdocs()+
    ylab(paste('Média de', variable_name ))
  
  out$mean_desv_plot_2 <-
    dframe %>% ggplot()+
    geom_point(aes(
      x=Tratamento,
      y=Y,
      color=RegHidrico,
      shape=RegHidrico),
      position = position_dodge(width = .75),alpha=0.5)+
    geom_point(aes(
      x=Tratamento,
      y=Mean,
      color=RegHidrico,
      shape=RegHidrico),
      data=dframe_summ,
      position = position_dodge(width = .75))+
    geom_errorbar(aes(
      x=Tratamento,
      y=Mean,
      color=RegHidrico,
      shape=RegHidrico,
      ymin=Mean-SD,ymax=Mean+SD),
      data=dframe_summ,
      width = 0.2,alpha=0.9,
      position = position_dodge(0.75))+
    theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
    scale_color_gdocs()+
    scale_fill_gdocs()+
    ylab(paste('Média de', variable_name ))

  return(out)
}

summ_qf_ccsm <- function(dframe,variable_name = ''){
  if (variable_name==''){
    stop()
  }
  dframe = dframe %>% select(one_of(variable_name),Manejo,Copa,PortaEnxerto)
  
  colnames(dframe)[1]<-'Y'
  out<- list()
  
  dframe = dframe %>% mutate(Tratamento = paste(Copa,'+',PortaEnxerto,sep=''))
  
  dframe_summ <- dframe %>% group_by(Manejo,Tratamento) %>% 
    summarise(Mean = mean(Y,na.rm=T),
              SD = sd(Y,na.rm=T)) %>% 
    mutate(`Mean ± SD`=paste(round(Mean,2),'±',round(SD,2)))
  
  
  out$dframe_summ <- dframe_summ
  
  out$barp <- dframe_summ %>% ggplot(
    aes(x=Manejo,
        fill=Tratamento,
        y=Mean)) +
    geom_bar(stat = 'identity',position = 'dodge')+
    theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
    scale_color_gdocs()+
    scale_fill_gdocs()+
    ylab(paste('Média de', variable_name ))
  
  out$barp_2 <- dframe_summ %>% ggplot(
    aes(x=Tratamento,
        fill=Manejo,
        y=Mean)) +
    geom_bar(stat = 'identity',position = 'dodge')+
    theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
    scale_color_gdocs()+
    scale_fill_gdocs()+
    ylab(paste('Média de', variable_name ))
  
  out$barp_error <-  dframe_summ %>% ggplot(
    aes(x=Manejo,
        fill=Tratamento,
        y=Mean)) +
    geom_bar(stat = 'identity',position = 'dodge')+
    theme_minimal(base_size=14)+theme(legend.position = 'bottom') +
    geom_errorbar(
      aes(x=Manejo,y=Mean,
          color=Tratamento,
          ymin=Mean-SD,ymax=Mean+SD),
      width = 0.2,alpha=0.8,stat = 'identity',color='black',
      position = position_dodge(0.9))+
    scale_color_gdocs()+
    scale_fill_gdocs()+
    ylab(paste('Média de', variable_name ))
  
   out$barp_error_2 <-  dframe_summ %>% ggplot(
    aes(x=Tratamento,
        fill=Manejo,
        y=Mean)) +
    geom_bar(stat = 'identity',position = 'dodge')+
    theme_minimal(base_size=14)+theme(legend.position = 'bottom') +
    geom_errorbar(
      aes(x=Tratamento,y=Mean,
          color=Manejo,
          ymin=Mean-SD,ymax=Mean+SD),
      width = 0.2,alpha=0.8,stat = 'identity',color='black',
      position = position_dodge(0.9))+
    scale_color_gdocs()+
    scale_fill_gdocs()+
    ylab(paste('Média de', variable_name ))
  
  out$mean_desv_plot <-
    dframe %>% ggplot()+
    geom_point(aes(
      x=Manejo,
      y=Y,
      color=Tratamento,
      shape=Tratamento),
      position = position_dodge(width = .75),alpha=0.5)+
    geom_point(aes(
      x=Manejo,
      y=Mean,
      color=Tratamento,
      shape=Tratamento),
      data=dframe_summ,
      position = position_dodge(width = .75))+
    geom_errorbar(aes(
      x=Manejo,
      y=Mean,
      color=Tratamento,
      shape=Tratamento,
      ymin=Mean-SD,ymax=Mean+SD),
      data=dframe_summ,
      width = 0.2,alpha=0.9,
      position = position_dodge(0.75))+
    theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
    scale_color_gdocs()+
    scale_fill_gdocs()+
    ylab(paste('Média de', variable_name ))
  
  out$mean_desv_plot_2 <-
    dframe %>% ggplot()+
    geom_point(aes(
      x=Tratamento,
      y=Y,
      color=Manejo,
      shape=Manejo),
      position = position_dodge(width = .75),alpha=0.5)+
    geom_point(aes(
      x=Tratamento,
      y=Mean,
      color=Manejo,
      shape=Manejo),
      data=dframe_summ,
      position = position_dodge(width = .75))+
    geom_errorbar(aes(
      x=Tratamento,
      y=Mean,
      color=Manejo,
      shape=Manejo,
      ymin=Mean-SD,ymax=Mean+SD),
      data=dframe_summ,
      width = 0.2,alpha=0.9,
      position = position_dodge(0.75))+
    theme_minimal(base_size=14)+theme(legend.position = 'bottom') + 
    scale_color_gdocs()+
    scale_fill_gdocs()+
    ylab(paste('Média de', variable_name ))

  return(out)
}

### model funcitons = 

dframe_aux = dframe_qf_ccsm
response='Massa'

fit_qf_ccsm <- function(dframe_aux,response){
  dframe_aux = dframe_aux %>% select(Manejo,PortaEnxerto,Copa,one_of(response))
  out_models = list()
  out_models$models <- list()
  
  ## Full Model
  out_models$models$fit_full          = lm(data=dframe_aux,get(response)~Manejo*PortaEnxerto*Copa)
  out_models$models$fit_full_aov      = aov(data=dframe_aux,get(response)~Manejo*PortaEnxerto*Copa)
  

  ## All 2*2 ints
  out_models$models$fit_noInt3        = lm(data=dframe_aux,get(response) ~ Manejo*Copa +Manejo*PortaEnxerto + PortaEnxerto*Copa)
  out_models$models$fit_noInt3_aov    = aov(data=dframe_aux,get(response)~ Manejo*Copa +Manejo*PortaEnxerto + PortaEnxerto*Copa)

  ## Only PortaEnxerto*Copa
  out_models$models$fit_CopPort       = lm(data=dframe_aux,get(response)~ Manejo + PortaEnxerto*Copa)
  out_models$models$fit_CopPort_aov   = aov(data=dframe_aux,get(response)~ Manejo + PortaEnxerto*Copa)

  ## Just main effects
  out_models$models$fit_mainEffect     = lm(data=dframe_aux,get(response)~ Manejo + PortaEnxerto + Copa)
  out_models$models$fit_mainEffect_aov = aov(data=dframe_aux,get(response)~ Manejo + PortaEnxerto + Copa)

  ### Tukey
  out_models$tukey <- list()
  
  
  
  tk <- TukeyHSD(out_models$models$fit_full_aov)
  mtcomp <- multcompView::multcompLetters4(out_models$models$fit_full_aov,tk)
  out_models$tukey$fit_full_aov  <-   
    dframe_aux %>% group_by(Manejo,PortaEnxerto,Copa) %>% 
    summarise(Mean=mean(get(response))) %>% 
    arrange(-Mean) %>% bind_cols(Group = mtcomp$`Manejo:PortaEnxerto:Copa`$Letters)
  
  
  tk <- TukeyHSD(out_models$models$fit_noInt3_aov)
  mtcomp <- multcompView::multcompLetters4(out_models$models$fit_noInt3_aov,tk)
  out_models$tukey$fit_noInt3_aov <- list(  
    dframe_aux %>% group_by(Manejo,Copa) %>% 
    summarise(Mean=mean(get(response))) %>% 
    arrange(-Mean) %>% bind_cols(Group = mtcomp$`Manejo:Copa`$Letters),
    
    dframe_aux %>% group_by(Manejo,PortaEnxerto) %>% 
    summarise(Mean=mean(get(response))) %>% 
    arrange(-Mean) %>% bind_cols(Group = mtcomp$`Manejo:PortaEnxerto`$Letters),
    
    dframe_aux %>% group_by(Copa,PortaEnxerto) %>% 
    summarise(Mean=mean(get(response))) %>% 
    arrange(-Mean) %>% bind_cols(Group = mtcomp$`Copa:PortaEnxerto`$Letters)
  )
  
  tk <- TukeyHSD(out_models$models$fit_CopPort_aov)
  mtcomp <- multcompView::multcompLetters4(out_models$models$fit_CopPort_aov,tk)
  out_models$tukey$fit_CopPort_aov <- list(  
    dframe_aux %>% group_by(Manejo,Copa) %>% 
    summarise(Mean=mean(get(response))) %>% 
    arrange(-Mean) %>% bind_cols(Group = mtcomp$`PortaEnxerto:Copa`$Letters),
    
    dframe_aux %>% group_by(Manejo) %>% 
    summarise(Mean=mean(get(response))) %>% 
    arrange(-Mean) %>% bind_cols(Group = mtcomp$Manejo$Letters),
    
    dframe_aux %>% group_by(Copa) %>% 
    summarise(Mean=mean(get(response))) %>% 
    arrange(-Mean) %>% bind_cols(Group = mtcomp$Copa$Letters),
    
    dframe_aux %>% group_by(PortaEnxerto) %>% 
    summarise(Mean=mean(get(response))) %>% 
    arrange(-Mean) %>% bind_cols(Group = mtcomp$PortaEnxerto$Letters)
  )
  
  tk <- TukeyHSD(out_models$models$fit_mainEffect_aov)
  mtcomp <- multcompView::multcompLetters4(out_models$models$fit_mainEffect_aov,tk)
  out_models$tukey$fit_mainEffect_aov <- list(  
    dframe_aux %>% group_by(Manejo) %>% 
    summarise(Mean=mean(get(response))) %>% 
    arrange(-Mean) %>% bind_cols(Group = mtcomp$Manejo$Letters),
    
    dframe_aux %>% group_by(Copa) %>% 
    summarise(Mean=mean(get(response))) %>% 
    arrange(-Mean) %>% bind_cols(Group = mtcomp$Copa$Letters),
    
    dframe_aux %>% group_by(PortaEnxerto) %>% 
    summarise(Mean=mean(get(response))) %>% 
    arrange(-Mean) %>% bind_cols(Group = mtcomp$PortaEnxerto$Letters)
  )
  return(out_models)
}
```


### UFScar {.tabset}

#### Massa {.tabset}
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results <- summ_qf(dframe_qf_ufscar,variable_name = "Massa")
```

##### Gráfico de Barras
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_2
```

##### Gráfico De Barras com erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error_2
```

##### Gráfico de Pontos + Média e Erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot_2
```

##### Tabela Resumo
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$dframe_summ %>% kable_cust()
```

#### Altura {.tabset}
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results <- summ_qf(dframe_qf_ufscar,variable_name = "Altura")
```

##### Gráfico de Barras
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_2
```

##### Gráfico De Barras com erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error_2
```

##### Gráfico de Pontos + Média e Erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot_2
```

##### Tabela Resumo
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$dframe_summ %>% kable_cust()
```

#### Largura {.tabset}
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results <- summ_qf(dframe_qf_ufscar,variable_name = "Largura")
```

##### Gráfico de Barras
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_2
```

##### Gráfico De Barras com erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error_2
```

##### Gráfico de Pontos + Média e Erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot_2
```

##### Tabela Resumo
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$dframe_summ %>% kable_cust()
```

#### AL {.tabset}
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results <- summ_qf(dframe_qf_ufscar,variable_name = "AL")
```

##### Gráfico de Barras
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_2
```

##### Gráfico De Barras com erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error_2
```

##### Gráfico de Pontos + Média e Erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot_2
```

##### Tabela Resumo
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$dframe_summ %>% kable_cust()
```

#### Suco {.tabset}
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results <- summ_qf(dframe_qf_ufscar,variable_name = "Suco")
```

##### Gráfico de Barras
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_2
```

##### Gráfico De Barras com erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error_2
```

##### Gráfico de Pontos + Média e Erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot_2
```

##### Tabela Resumo
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$dframe_summ %>% kable_cust()
```

#### Acidez {.tabset}
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results <- summ_qf(dframe_qf_ufscar,variable_name = "Acidez")
```

##### Gráfico de Barras
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_2
```

##### Gráfico De Barras com erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error_2
```

##### Gráfico de Pontos + Média e Erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot_2
```

##### Tabela Resumo
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$dframe_summ %>% kable_cust()
```

#### BrixCorr {.tabset}
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results <- summ_qf(dframe_qf_ufscar,variable_name = "BrixCorr")
```

##### Gráfico de Barras
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_2
```

##### Gráfico De Barras com erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error_2
```

##### Gráfico de Pontos + Média e Erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot_2
```

##### Tabela Resumo
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$dframe_summ %>% kable_cust()
```

#### Ratio {.tabset}
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results <- summ_qf(dframe_qf_ufscar,variable_name = "Ratio")
```

##### Gráfico de Barras
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_2
```

##### Gráfico De Barras com erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error_2
```

##### Gráfico de Pontos + Média e Erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot_2
```

##### Tabela Resumo
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$dframe_summ %>% kable_cust()
```

#### IT {.tabset}
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results <- summ_qf(dframe_qf_ufscar,variable_name = "IT")
```

##### Gráfico de Barras
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_2
```

##### Gráfico De Barras com erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error_2
```

##### Gráfico de Pontos + Média e Erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot_2
```

##### Tabela Resumo
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$dframe_summ %>% kable_cust()
```

#### VitC {.tabset}
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results <- summ_qf(dframe_qf_ufscar,variable_name = "VitC")
```

##### Gráfico de Barras
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_2
```

##### Gráfico De Barras com erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error_2
```

##### Gráfico de Pontos + Média e Erro
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot_2
```

##### Tabela Resumo
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$dframe_summ %>% kable_cust()
```


### CCSM {.tabset}

#### Massa
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results <- summ_qf_ccsm(dframe_qf_ccsm,variable_name = "Massa")
models <- fit_qf_ccsm(dframe_qf_ccsm,'Massa')
```

##### Graficos {.tabset}

###### Barplot 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp
```

###### Barplot 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_2
```

###### Barplot + SD 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error
```

###### Barplot + SD 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error_2
```

###### Mean Error 1 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot
```

###### Mean Error 2 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot_2
```

###### Tabela Resumo
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$dframe_summ %>% kable_cust()
```

##### Modelos {.tabset}

###### Full 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
models$tukey$fit_full_aov %>% kable_cust()
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_full_aov)
```

```{r}
summary(models$models$fit_full)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_full_aov)
par(mfrow=c(1,1))
```

###### 2x2 Interaction

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100,results = "asis"}
lapply(models$tukey$fit_noInt3_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_noInt3_aov)
```

```{r}
summary(models$models$fit_noInt3)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_noInt3_aov)
par(mfrow=c(1,1))
```


###### Copa*PortaEnxerto Interaction + Manejo

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100,results = "asis"}
lapply(models$tukey$fit_CopPort_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_CopPort_aov)
```

```{r}
summary(models$models$fit_CopPort)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_CopPort_aov)
par(mfrow=c(1,1))
```


###### Main Effects
```{r,results = "asis"}
lapply(models$tukey$fit_mainEffect_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_mainEffect_aov)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_mainEffect)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_mainEffect_aov)
par(mfrow=c(1,1))
```



#### Altura
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results <- summ_qf_ccsm(dframe_qf_ccsm,variable_name = "Altura")
models <- fit_qf_ccsm(dframe_qf_ccsm,'Altura')
```

##### Graficos {.tabset}

###### Barplot 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp
```

###### Barplot 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_2
```

###### Barplot + SD 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error
```

###### Barplot + SD 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error_2
```

###### Mean Error 1 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot
```

###### Mean Error 2 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot_2
```

###### Tabela Resumo
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$dframe_summ %>% kable_cust()
```

##### Modelos {.tabset}

###### Full 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
models$tukey$fit_full_aov %>% kable_cust()
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_full_aov)
```

```{r}
summary(models$models$fit_full)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_full_aov)
par(mfrow=c(1,1))
```

###### 2x2 Interaction

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100,results = "asis"}
lapply(models$tukey$fit_noInt3_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_noInt3_aov)
```

```{r}
summary(models$models$fit_noInt3)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_noInt3_aov)
par(mfrow=c(1,1))
```


###### Copa*PortaEnxerto Interaction + Manejo

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100,results = "asis"}
lapply(models$tukey$fit_CopPort_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_CopPort_aov)
```

```{r}
summary(models$models$fit_CopPort)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_CopPort_aov)
par(mfrow=c(1,1))
```


###### Main Effects
```{r,results = "asis"}
lapply(models$tukey$fit_mainEffect_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_mainEffect_aov)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_mainEffect)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_mainEffect_aov)
par(mfrow=c(1,1))
```

#### AL
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results <- summ_qf_ccsm(dframe_qf_ccsm,variable_name = "AL")
models <- fit_qf_ccsm(dframe_qf_ccsm,'AL')
```

##### Graficos {.tabset}

###### Barplot 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp
```

###### Barplot 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_2
```

###### Barplot + SD 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error
```

###### Barplot + SD 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error_2
```

###### Mean Error 1 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot
```

###### Mean Error 2 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot_2
```

###### Tabela Resumo
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$dframe_summ %>% kable_cust()
```

##### Modelos {.tabset}

###### Full 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
models$tukey$fit_full_aov %>% kable_cust()
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_full_aov)
```

```{r}
summary(models$models$fit_full)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_full_aov)
par(mfrow=c(1,1))
```

###### 2x2 Interaction

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100,results = "asis"}
lapply(models$tukey$fit_noInt3_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_noInt3_aov)
```

```{r}
summary(models$models$fit_noInt3)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_noInt3_aov)
par(mfrow=c(1,1))
```


###### Copa*PortaEnxerto Interaction + Manejo

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100,results = "asis"}
lapply(models$tukey$fit_CopPort_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_CopPort_aov)
```

```{r}
summary(models$models$fit_CopPort)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_CopPort_aov)
par(mfrow=c(1,1))
```


###### Main Effects
```{r,results = "asis"}
lapply(models$tukey$fit_mainEffect_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_mainEffect_aov)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_mainEffect)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_mainEffect_aov)
par(mfrow=c(1,1))
```

#### Acidez
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results <- summ_qf_ccsm(dframe_qf_ccsm,variable_name = "Acidez")
models <- fit_qf_ccsm(dframe_qf_ccsm,'Acidez')
```

##### Graficos {.tabset}

###### Barplot 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp
```

###### Barplot 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_2
```

###### Barplot + SD 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error
```

###### Barplot + SD 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error_2
```

###### Mean Error 1 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot
```

###### Mean Error 2 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot_2
```

###### Tabela Resumo
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$dframe_summ %>% kable_cust()
```

##### Modelos {.tabset}

###### Full 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
models$tukey$fit_full_aov %>% kable_cust()
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_full_aov)
```

```{r}
summary(models$models$fit_full)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_full_aov)
par(mfrow=c(1,1))
```

###### 2x2 Interaction

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100,results = "asis"}
lapply(models$tukey$fit_noInt3_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_noInt3_aov)
```

```{r}
summary(models$models$fit_noInt3)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_noInt3_aov)
par(mfrow=c(1,1))
```


###### Copa*PortaEnxerto Interaction + Manejo

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100,results = "asis"}
lapply(models$tukey$fit_CopPort_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_CopPort_aov)
```

```{r}
summary(models$models$fit_CopPort)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_CopPort_aov)
par(mfrow=c(1,1))
```

###### Main Effects
```{r,results = "asis"}
lapply(models$tukey$fit_mainEffect_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_mainEffect_aov)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_mainEffect)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_mainEffect_aov)
par(mfrow=c(1,1))
```

#### BrixCorr
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results <- summ_qf_ccsm(dframe_qf_ccsm,variable_name = "BrixCorr")
models <- fit_qf_ccsm(dframe_qf_ccsm,'BrixCorr')
```

##### Graficos {.tabset}

###### Barplot 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp
```

###### Barplot 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_2
```

###### Barplot + SD 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error
```

###### Barplot + SD 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error_2
```

###### Mean Error 1 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot
```

###### Mean Error 2 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot_2
```

###### Tabela Resumo
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$dframe_summ %>% kable_cust()
```

##### Modelos {.tabset}

###### Full 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
models$tukey$fit_full_aov %>% kable_cust()
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_full_aov)
```

```{r}
summary(models$models$fit_full)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_full_aov)
par(mfrow=c(1,1))
```

###### 2x2 Interaction

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100,results = "asis"}
lapply(models$tukey$fit_noInt3_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_noInt3_aov)
```

```{r}
summary(models$models$fit_noInt3)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_noInt3_aov)
par(mfrow=c(1,1))
```


###### Copa*PortaEnxerto Interaction + Manejo

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100,results = "asis"}
lapply(models$tukey$fit_CopPort_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_CopPort_aov)
```

```{r}
summary(models$models$fit_CopPort)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_CopPort_aov)
par(mfrow=c(1,1))
```

###### Main Effects
```{r,results = "asis"}
lapply(models$tukey$fit_mainEffect_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_mainEffect_aov)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_mainEffect)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_mainEffect_aov)
par(mfrow=c(1,1))
```

#### Ratio
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results <- summ_qf_ccsm(dframe_qf_ccsm,variable_name = "Ratio")
models <- fit_qf_ccsm(dframe_qf_ccsm,'Ratio')
```

##### Graficos {.tabset}

###### Barplot 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp
```

###### Barplot 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_2
```

###### Barplot + SD 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error
```

###### Barplot + SD 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error_2
```

###### Mean Error 1 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot
```

###### Mean Error 2 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot_2
```

###### Tabela Resumo
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$dframe_summ %>% kable_cust()
```

##### Modelos {.tabset}

###### Full 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
models$tukey$fit_full_aov %>% kable_cust()
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_full_aov)
```

```{r}
summary(models$models$fit_full)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_full_aov)
par(mfrow=c(1,1))
```

###### 2x2 Interaction

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100,results = "asis"}
lapply(models$tukey$fit_noInt3_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_noInt3_aov)
```

```{r}
summary(models$models$fit_noInt3)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_noInt3_aov)
par(mfrow=c(1,1))
```


###### Copa*PortaEnxerto Interaction + Manejo

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100,results = "asis"}
lapply(models$tukey$fit_CopPort_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_CopPort_aov)
```

```{r}
summary(models$models$fit_CopPort)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_CopPort_aov)
par(mfrow=c(1,1))
```

###### Main Effects
```{r,results = "asis"}
lapply(models$tukey$fit_mainEffect_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_mainEffect_aov)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_mainEffect)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_mainEffect_aov)
par(mfrow=c(1,1))
```

#### IT
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results <- summ_qf_ccsm(dframe_qf_ccsm,variable_name = "IT")
models <- fit_qf_ccsm(dframe_qf_ccsm,'IT')
```

##### Graficos {.tabset}

###### Barplot 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp
```

###### Barplot 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_2
```

###### Barplot + SD 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error
```

###### Barplot + SD 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error_2
```

###### Mean Error 1 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot
```

###### Mean Error 2 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot_2
```

###### Tabela Resumo
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$dframe_summ %>% kable_cust()
```

##### Modelos {.tabset}

###### Full 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
models$tukey$fit_full_aov %>% kable_cust()
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_full_aov)
```

```{r}
summary(models$models$fit_full)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_full_aov)
par(mfrow=c(1,1))
```

###### 2x2 Interaction

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100,results = "asis"}
lapply(models$tukey$fit_noInt3_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_noInt3_aov)
```

```{r}
summary(models$models$fit_noInt3)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_noInt3_aov)
par(mfrow=c(1,1))
```


###### Copa*PortaEnxerto Interaction + Manejo

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100,results = "asis"}
lapply(models$tukey$fit_CopPort_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_CopPort_aov)
```

```{r}
summary(models$models$fit_CopPort)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_CopPort_aov)
par(mfrow=c(1,1))
```

###### Main Effects
```{r,results = "asis"}
lapply(models$tukey$fit_mainEffect_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_mainEffect_aov)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_mainEffect)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_mainEffect_aov)
par(mfrow=c(1,1))
```


#### VitC 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results <- summ_qf_ccsm(dframe_qf_ccsm,variable_name = "VitC")
models <- fit_qf_ccsm(dframe_qf_ccsm,'VitC')
```

##### Graficos {.tabset}

###### Barplot 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp
```

###### Barplot 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_2
```

###### Barplot + SD 1
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error
```

###### Barplot + SD 2
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$barp_error_2
```

###### Mean Error 1 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot
```

###### Mean Error 2 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$mean_desv_plot_2
```

###### Tabela Resumo
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
results$dframe_summ %>% kable_cust()
```

##### Modelos {.tabset}

###### Full 
```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
models$tukey$fit_full_aov %>% kable_cust()
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_full_aov)
```

```{r}
summary(models$models$fit_full)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_full_aov)
par(mfrow=c(1,1))
```

###### 2x2 Interaction

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100,results = "asis"}
lapply(models$tukey$fit_noInt3_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_noInt3_aov)
```

```{r}
summary(models$models$fit_noInt3)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_noInt3_aov)
par(mfrow=c(1,1))
```


###### Copa*PortaEnxerto Interaction + Manejo

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100,results = "asis"}
lapply(models$tukey$fit_CopPort_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_CopPort_aov)
```

```{r}
summary(models$models$fit_CopPort)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_CopPort_aov)
par(mfrow=c(1,1))
```

###### Main Effects
```{r,results = "asis"}
lapply(models$tukey$fit_mainEffect_aov,kable_cust)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_mainEffect_aov)
```

```{r,fig.align='center',fig.height=4,fig.width=8,dpi=100}
summary(models$models$fit_mainEffect)$coeff %>% kable_cust()
```

```{r,fig.align='center',fig.height=8,fig.width=8,dpi=100}
par(mfrow=c(2,2))
plot(models$models$fit_mainEffect_aov)
par(mfrow=c(1,1))
```



